{"ast":null,"code":"var _jsxFileName = \"/home/dci/Desktop/AllAufgaben/mywunderbar/Github push/gh-Final_projekt/frontend/src/components/Navbar/Pages/Articles.js\",\n    _s = $RefreshSig$();\n\nimport CreateArticle from \"../../Articles/CreateArticle/CreateArticle\";\nimport Article from \"../../Articles/Article/Article\";\nimport AllArticles from \"../../Articles/AllArticles/AllArticles\";\nimport { useState, useEffect } from \"react\";\nimport { Route, Switch } from \"react-router-dom\";\nimport { useJwt } from \"react-jwt\";\nimport Loading from \"../../Loading/Loading\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst token = localStorage.getItem(\"food-token\");\n\nconst Articles = () => {\n  _s();\n\n  const {\n    decodedToken\n  } = useJwt(token);\n  const [articles, setArticles] = useState([]);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    getArticlesData();\n  }, []);\n  useEffect(() => {}, [articles]);\n\n  const doesUserHaveArticle = async articleId => {\n    const getUrl = `http://localhost:3369/articles/userhasarticle/${articleId}`;\n    const data = await fetch(getUrl, {\n      method: 'GET',\n      headers: {\n        'Authorization': localStorage.getItem(\"food-token\") || \"\"\n      }\n    });\n    const res = await data.text(); // Wenn Article zu user gehört kommt \"authorized\"\n\n    if (res !== \"authorized\") {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  const getArticlesData = async () => {\n    const data = await fetch(\"http://localhost:3369/articles\");\n    const res = await data.json();\n    const updatedArray = await Promise.all(res.map(async article => {\n      const canEdit = await doesUserHaveArticle(article._id);\n      return { ...article,\n        canEdit: canEdit\n      };\n    }));\n    setArticles(updatedArray.reverse());\n    setLoading(false);\n  };\n  /*   setTimeout(function () {\n        setLoading(false);\n    }, 2800); */\n\n\n  const addNewArticle = async newArticle => {\n    newArticle.userId = decodedToken.id;\n    setLoading(true);\n    const res = await fetch('http://localhost:3369/articles', {\n      method: 'POST',\n      mode: 'cors',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(newArticle)\n    }); // TODO IF YOUR REALLY WANN RELOAD location.reload();\n\n    const newArticleApi = await res.json();\n    const upditArticle = [{ ...newArticleApi,\n      canEdit: true\n    }, ...articles];\n    setArticles(upditArticle);\n    setLoading(false);\n  };\n\n  const deleteArticle = async id => {\n    const confirm = prompt(\"Please confirm the delete of the article with YES\");\n\n    if (confirm === \"YES\" || confirm === \"yes\") {\n      const deleteUrl = `http://localhost:3369/articles/${id}`;\n      const res = await fetch(deleteUrl, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': localStorage.getItem(\"food-token\") || \"\"\n        }\n      });\n\n      if (res.status === 200) {\n        alert(\"Article was deleted!\");\n      } else {\n        alert(\"Some Error happened\");\n      }\n    } else {\n      alert(\"Please confirm correctly\");\n    }\n    /*     const result = await res.json();\n        if (result.err) {\n            alert('This Article is not for you');\n        }  */\n\n\n    const articlesDeleteUpate = articles.filter(article => article._id !== id);\n    setArticles(articlesDeleteUpate);\n  };\n\n  const updateArticle = async (id, artUpdate) => {\n    const updateUrl = `http://localhost:3369/articles/${id}`;\n    const res = await fetch(updateUrl, {\n      method: \"PUT\",\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': localStorage.getItem(\"food-token\") || \"\"\n      },\n      body: JSON.stringify(artUpdate)\n    });\n    const result = await res.json();\n\n    if (result.err) {\n      alert('This Article is not for you');\n    } // const newArticleApi = await res.json();\n    // console.log('newArticleApi', newArticleApi)\n    // const ArticleUpdated = articles.map(article => article._id === id ? artUpdate : article);\n    // setArticles(ArticleUpdated)\n    // console.log(\"state set: \", articles)\n\n\n    getArticlesData();\n    setLoading(false);\n  };\n  /*     const getArticleById = (id) => {\n   \n          const article = articles.find(art => art._id === id);\n          console.log('article => ', article)\n          return article;\n      } */\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Switch, {\n      children: [/*#__PURE__*/_jsxDEV(Route, {\n        path: \"/articles\",\n        children: loading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 32\n        }, this) : /*#__PURE__*/_jsxDEV(AllArticles, {\n          data: articles\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 46\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/create-article\",\n        children: loading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 32\n        }, this) : /*#__PURE__*/_jsxDEV(CreateArticle, {\n          data: articles,\n          addNewArticle: addNewArticle,\n          deleteArticle: deleteArticle,\n          updateArticle: updateArticle,\n          doesUserHaveArticle: doesUserHaveArticle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/article/:title\",\n        component: Article\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Articles, \"DkW3H+GCOngQ1uO5eu8w4TsJojk=\", false, function () {\n  return [useJwt];\n});\n\n_c = Articles;\nexport default Articles;\n\nvar _c;\n\n$RefreshReg$(_c, \"Articles\");","map":{"version":3,"sources":["/home/dci/Desktop/AllAufgaben/mywunderbar/Github push/gh-Final_projekt/frontend/src/components/Navbar/Pages/Articles.js"],"names":["CreateArticle","Article","AllArticles","useState","useEffect","Route","Switch","useJwt","Loading","token","localStorage","getItem","Articles","decodedToken","articles","setArticles","loading","setLoading","getArticlesData","doesUserHaveArticle","articleId","getUrl","data","fetch","method","headers","res","text","json","updatedArray","Promise","all","map","article","canEdit","_id","reverse","addNewArticle","newArticle","userId","id","mode","body","JSON","stringify","newArticleApi","upditArticle","deleteArticle","confirm","prompt","deleteUrl","status","alert","articlesDeleteUpate","filter","updateArticle","artUpdate","updateUrl","result","err"],"mappings":"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","sourcesContent":["import CreateArticle from \"../../Articles/CreateArticle/CreateArticle\";\nimport Article from \"../../Articles/Article/Article\";\nimport AllArticles from \"../../Articles/AllArticles/AllArticles\";\nimport { useState, useEffect } from \"react\";\nimport { Route, Switch } from \"react-router-dom\";\nimport { useJwt } from \"react-jwt\";\nimport Loading from \"../../Loading/Loading\";\n\nconst token = localStorage.getItem(\"food-token\")\n\nconst Articles = () => {\n    const { decodedToken} = useJwt(token);\n\n    const [articles, setArticles] = useState([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        getArticlesData();\n    }, [])\n\n    useEffect(() => {\n       \n\n\n    }, [articles])\n\n    const doesUserHaveArticle = async (articleId) => {\n        const getUrl = `http://localhost:3369/articles/userhasarticle/${articleId}`;\n        const data = await fetch(getUrl, {\n            method: 'GET',\n            headers: {\n                'Authorization': localStorage.getItem(\"food-token\") || \"\"\n            }\n        });\n        const res = await data.text();\n        // Wenn Article zu user gehört kommt \"authorized\"\n        if (res !== \"authorized\") {\n            return false;\n        } else {\n            return true;\n        }\n    }\n\n    const getArticlesData = async () => {\n        const data = await fetch(\"http://localhost:3369/articles\");\n        const res = await data.json();\n\n\n        const updatedArray = await Promise.all(res.map(async article => {\n            const canEdit = await doesUserHaveArticle(article._id);\n            return { ...article, canEdit: canEdit }\n        }))\n        \n        setArticles(updatedArray.reverse());\n        setLoading(false);\n\n    }\n    /*   setTimeout(function () {\n          setLoading(false);\n      }, 2800); */\n\n\n    const addNewArticle = async (newArticle) => {\n       \n        newArticle.userId = decodedToken.id;\n        setLoading(true)\n        const res = await fetch('http://localhost:3369/articles', {\n            method: 'POST',\n            mode: 'cors',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(newArticle)\n        });\n        // TODO IF YOUR REALLY WANN RELOAD location.reload();\n\n       \n        const newArticleApi = await res.json();\n        \n        const upditArticle = [{ ...newArticleApi, canEdit: true }, ...articles]\n        setArticles(upditArticle)\n\n        setLoading(false);\n\n\n    }\n\n    const deleteArticle = async (id) => {\n        const confirm = prompt(\"Please confirm the delete of the article with YES\");\n        if (confirm === \"YES\" || confirm === \"yes\") {\n            const deleteUrl = `http://localhost:3369/articles/${id}`;\n            const res = await fetch(deleteUrl, {\n                method: 'DELETE',\n                headers: {\n                    'Authorization': localStorage.getItem(\"food-token\") || \"\"\n                }\n\n            });\n            if (res.status === 200) {\n                alert(\"Article was deleted!\")\n            } else {\n                alert(\"Some Error happened\")\n            }\n        } else {\n            alert(\"Please confirm correctly\")\n        }\n\n\n        /*     const result = await res.json();\n            if (result.err) {\n                alert('This Article is not for you');\n            }  */\n        const articlesDeleteUpate = articles.filter(article => article._id !== id)\n        setArticles(articlesDeleteUpate);\n\n\n    }\n\n    const updateArticle = async (id, artUpdate) => {\n        const updateUrl = `http://localhost:3369/articles/${id}`;\n\n        const res = await fetch(updateUrl, {\n            method: \"PUT\",\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': localStorage.getItem(\"food-token\") || \"\"\n            },\n\n            body: JSON.stringify(artUpdate)\n\n        });\n\n\n        const result = await res.json();\n        if (result.err) {\n            alert('This Article is not for you');\n        }\n\n        // const newArticleApi = await res.json();\n        // console.log('newArticleApi', newArticleApi)\n        // const ArticleUpdated = articles.map(article => article._id === id ? artUpdate : article);\n        // setArticles(ArticleUpdated)\n        // console.log(\"state set: \", articles)\n\n        getArticlesData();\n        setLoading(false);\n    }\n\n    /*     const getArticleById = (id) => {\n     \n            const article = articles.find(art => art._id === id);\n            console.log('article => ', article)\n            return article;\n        } */\n\n\n    return (\n        <div >\n            <Switch>\n                <Route path='/articles'>\n                    {loading ? <Loading /> : <AllArticles\n                        data={articles}\n\n                    />}\n                </Route>\n\n                <Route path='/create-article'>\n\n\n\n                    {loading ? <Loading /> :\n                        <CreateArticle\n                            data={articles}\n                            addNewArticle={addNewArticle}\n                            deleteArticle={deleteArticle}\n                            updateArticle={updateArticle}\n                            doesUserHaveArticle={doesUserHaveArticle}\n                        />\n                    }\n\n                </Route>\n\n\n                <Route path='/article/:title' component={Article}>\n                    {/*   <Article getArticleById={getArticleById} /> */}\n                </Route>\n\n            </Switch>\n\n\n        </div>\n    )\n}\nexport default Articles;"]},"metadata":{},"sourceType":"module"}